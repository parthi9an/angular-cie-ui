/**
 * Tool Window Resize Event controller
 */

function ToolWindowResizeEventCtrl(conf, apiUrl, apiService, $scope, $http,
		filterGroup, $modal, $compile) {

	var _this = this;

	this.showWndGraph = true;

	$scope.selected = filterGroup.getSelectedFilter();
	
	this.init = function() {
		
		if(Array.isArray($scope.selected['context_type']) && $scope.selected['context_type'].length > 0)
		  _this.getCountOfMovedWindow($scope.selected);
	}

	$scope.$on('populateSearch', function(event, args) {
		_this.getCountOfMovedWindow(args);
	});
	
	$scope.$on('contextTypeUpdated', function(event) {
		_this.getCountOfMovedWindow($scope.selected);
	});

	/*
	 * Counts of how many times each window is moved or resized
            what views are visible when they do this?
	 * Pie chart
	 */

	this.getCountOfMovedWindow = function(args) {
		
		var wArgs = {};
		angular.copy(args, wArgs);
		if((!args['context_type'] || args['context_type'].length == 0) && $scope.filterList != 'undefined'){
			wArgs['context_type'] = $scope.filterList.context_type;
		}
				
		apiService.post(apiUrl.GET_COUNT_OF_MOVED_WINDOW, wArgs,
				function(data, status) {
					if (data.name.length == 0) {
						_this.showWndGraph = false;
					} else {
						_this.showWndGraph = true;
					}
					_this.windowResizeData = data;
				});
	}

	this.init();

}

/**
 * 
 * Pass all functions into module
 */

angular.module('cie').controller('ToolWindowResizeEventCtrl', ToolWindowResizeEventCtrl);